getwd()   to know working directory
install.packages("..........")
library(".......")    #to know the available tools in that
counts <- read_csv("data/GSE60450_GeneLevel_Normalized(CPM.and.TMM)_data.csv")    #read file into counts
sampleinfo <- read_csv("data/GSE60450_filtered_metadata-1.csv")   # for sample informations
dim(sampleinfo)  #for know dimentions
head(sampleinfo) #1st 6 lines
view(sampleinfo)
colnames(sampleinfo)
sampleinfo$characteristics # listing charactoristic column
colnames(sampleinfo)[1] <- sample_id  # change column 1 name to sample_id
summary(sampleinfo)  #summary of the data
seqdata <- pivot_longer(counts, cols = starts_with("GSM"), names_to = "Sample", values_to = "Count")  #formating the data wide to long
seqdata <- pivot_longer(counts, cols = GSM1480291:GSM1480302, names_to = "Sample", values_to = "Count")   #formating the data wide to long
seqdata <- pivot_longer(counts, cols = -c("gene_id", "gene_symbol"), names_to = "Sample", values_to = "Count") # -c is for ignore gene_id and gene_symbol
allinfo <- full_join(seqdata, sampleinfo, by = c("Sample" = "sample_id"))  # join two data

MAKING ggplot
ggplot(data = allinfo, mapping = aes(x = Sample, y = Count)) + geom_boxplot() 
ggplot(data = allinfo, mapping = aes(x = Sample, y = log2(Count))) + geom_boxplot()
ggplot(data = allinfo, mapping = aes(x = Sample, y = log2(Count + 1))) + geom_boxplot()  # to avoid 0 log that is undifined
ggplot(data = allinfo, mapping = aes(x = Sample, y = log2(Count + 1))) + geom_violin() # other type of plot
ggplot(data = allinfo, mapping = aes(x = Sample, y = log2(Count + 1), colour = Sample)) +
+     geom_boxplot() # colour the sample
ggplot(data = allinfo, mapping = aes(x = Sample, y = log2(Count + 1), fill = Sample)) +
+     geom_boxplot()

